---
title: 定向流量变为通用免流
date: 2019-09-19 10:54:51
tags:  娱乐
category:  娱乐
---

需求: 我用的移动大王卡,定向流量每月 30G,通用流量 2G, 想把定向流量变为通用流量


1. 搭建 ssr, 用的秋水逸冰的一键脚本,注意 `80`端口,
 配置如下:
 
 ```
 Congratulations, ShadowsocksR server install completed!
 Your Server IP        :  1******
 Your Server Port      :  80
 Your Password         :  28456049
 Your Protocol         :  origin
 Your obfs             :  http_simple
 Your Encryption Method:  aes-256-cfb
 ```
2. 手机抓包,用的(无Root抓包:Packet Capture),今日头条极速版看视频走的定向流量,查看 header 头和 Host;
抓包结果:

```
GET /9b7d083ae02422c5fce6fe563968c3b5/5f5c7a68/video/tos/cn/tos-cn-ve-0026/b445df8c056b4b84ae56cc5d4d71af9c/?a=35&br=1026&bt=342&cr=1&cs=1&cv=1&dr=0&ds=1&er=&l=20200912143345010129039217075953A7&lr=&mime_type=video_mp4&qs=0&rc=am5va3U8NzNzdzMzO2QzM0ApaTUzODs1PDs0N2lpaDZmaWdtcC9wYmNeY19fLS00Li9zczBjYDI0Yy9eXzEwMTJjYTQ6Yw%3D%3D&vl=&vr= HTTP/1.1
User-Agent: ttplayer(2.9.33.35)
Accept: */*
Range: bytes=0-
Connection: close
Icy-MetaData: 1
X-Tt-Traceid: X-Tt-Traceid:1599892720439T4078
Host: v1-tt.ixigua.com
```

3. 修改混淆参数实现免流/变流

```
v1-tt.ixigua.com\r\n
User-Agent: ttplayer(2.9.33.35)\r\n
Accept: */*\r\n
Range: bytes=0-\r\n
Connection: close\r\n
Icy-MetaData: 1\r\n
X-Tt-Traceid: X-Tt-Traceid:1599892720439T4078
```
4. 其他

很多小伙伴还在用最简单的写法，即一个host，大部分情况下的确是够了，

但有时候配合User-Agent和Accept等信息会有奇效，尤其是现在越来越多的定向卡需要验证手机（卡）信息的情况下。

要想达到像tiny那样可以被运营商系统逐行识别的效果，必须这样写：

（1）灰色版SSR混淆写法(即1\r\n2\r\n3)

mmsc.monternet.com\r\n
Accept: */*, application/vnd.wap.mms-message, application/vnd.wap.sic\r\n
Content-Type: application/vnd.wap.mms-message\r\n
User-Agent: Android-Mms/2.0\nmmsc.monternet.com
（2）粉色版SSR混淆写法(即1#2\n3)：

```
mmsc.monternet.com#
Accept: */*, application/vnd.wap.mms-message, application/vnd.wap.sic\n
Content-Type: application/vnd.wap.mms-message\n
User-Agent: Android-Mms/2.0\nmmsc.monternet.com
```


作者实测抓包效果如下：
```
Host： Mmsc.monternet.com：8080\r\n
Accept:  */*, application/vnd.wap.mms-message, application/vnd.wap.sic\r\n
Content-Type:  application/vnd.wap.mms-message\r\n
User-Agent:  Android-Mms/2.0 \r\n
```
抓到混淆参数，打开SSR软件填到混淆参数的输入框中，让SSR软件保留在后台。

百度输入“ip”回车，如果显示的是你的服务器IP即证明配置成功。

接下来就是测试免不免流量了，方法是先关闭网络，开关几次飞行模式，5分钟后打开网络按上面的教程连接SSR后进移动app查询流量，然后下载5M左右的文件，再重复开头的方法关网开飞行等5分钟后再查流量，如果流量没少，即证明99%免流成功

注意，SSR软件一定要保留在后台运行，不然会扣流量


